{
  "summary": {
    "total_tests": 24,
    "passed_tests": 22,
    "failed_tests": 2,
    "error_tests": 0,
    "pass_rate": 91.66666666666666,
    "test_time": "2025-08-15T11:55:34.117085",
    "categories": {
      "基础功能": {
        "total": 2,
        "pass": 2,
        "fail": 0,
        "error": 0
      },
      "聊天功能": {
        "total": 3,
        "pass": 2,
        "fail": 1,
        "error": 0
      },
      "会话管理": {
        "total": 4,
        "pass": 4,
        "fail": 0,
        "error": 0
      },
      "错误处理": {
        "total": 6,
        "pass": 6,
        "fail": 0,
        "error": 0
      },
      "性能测试": {
        "total": 2,
        "pass": 2,
        "fail": 0,
        "error": 0
      },
      "边界测试": {
        "total": 4,
        "pass": 3,
        "fail": 1,
        "error": 0
      },
      "内容质量": {
        "total": 3,
        "pass": 3,
        "fail": 0,
        "error": 0
      }
    }
  },
  "results": [
    {
      "test_name": "健康检查",
      "category": "基础功能",
      "status": "PASS",
      "duration": 0.009974002838134766,
      "start_time": 1755229982.841377,
      "end_time": 1755229982.851351,
      "expected": "200状态码和服务状态信息",
      "actual": "状态码: 200, 响应: {\n  \"status\": \"healthy\",\n  \"timestamp\": 1755229982.850525,\n  \"qcli_available\": true,\n  \"active_sessions\": 2,\n  \"version\": \"1.0.0\"\n}",
      "error_message": null,
      "response_data": {
        "status": "healthy",
        "timestamp": 1755229982.850525,
        "qcli_available": true,
        "active_sessions": 2,
        "version": "1.0.0"
      },
      "performance_data": {}
    },
    {
      "test_name": "根路径访问",
      "category": "基础功能",
      "status": "PASS",
      "duration": 0.0017132759094238281,
      "start_time": 1755229982.8513548,
      "end_time": 1755229982.853068,
      "expected": "200状态码和服务信息",
      "actual": "状态码: 200, 响应: {\"endpoints\":{\"chat\":\"/api/v1/chat\",\"health\":\"/health\",\"session_files\":\"/api/v1/sessions/{session_id}/files\",\"sessions\":\"/api/v1/sessions\",\"stream_chat\":\"/api/v1/chat/stream\"},\"service\":\"Amazon Q CLI ",
      "error_message": null,
      "response_data": {
        "endpoints": {
          "chat": "/api/v1/chat",
          "health": "/health",
          "session_files": "/api/v1/sessions/{session_id}/files",
          "sessions": "/api/v1/sessions",
          "stream_chat": "/api/v1/chat/stream"
        },
        "service": "Amazon Q CLI API Service",
        "status": "running",
        "version": "1.0.0"
      },
      "performance_data": {}
    },
    {
      "test_name": "标准聊天",
      "category": "聊天功能",
      "status": "PASS",
      "duration": 14.985062837600708,
      "start_time": 1755229982.8531141,
      "end_time": 1755229997.838177,
      "expected": "200状态码，包含session_id、message、timestamp",
      "actual": "状态码: 200, 字段完整: True",
      "error_message": null,
      "response_data": {
        "session_id": "9fe9bdfd-b392-481a-aaef-59d49996127f",
        "message": "我理解您想要基于之前的对话历史来回答问题，但是我没有看到您提供的对话历史内容，也没有看到您的具体问题。\n请您：\n1. 提供之前的对话历史内容\n2. 明确说明您希望我回答的具体问题\n这样我就能基于上下文为您提供准确的中文回答了。\n您好！我是 Amazon Q，很高兴为您服务。我收到了您的测试消息。\n我可以帮助您：\n• 管理和查询 AWS 资源\n• 执行命令行操作\n• 读写文件和目录\n• 编写和调试代码\n• 提供 AWS 最佳实践建议\n• 解决技术问题",
        "timestamp": 1755229997.8356988
      },
      "performance_data": {}
    },
    {
      "test_name": "流式聊天",
      "category": "聊天功能",
      "status": "PASS",
      "duration": 7.135838747024536,
      "start_time": 1755229997.838185,
      "end_time": 1755230004.9740238,
      "expected": "SSE流式响应",
      "actual": "收到 5 个数据块",
      "error_message": null,
      "response_data": {
        "chunks": [
          "{'session_id': '374a9c70-16a0-45da-a73c-ebc81ed31454', 'type': 'session'}",
          "{'message': '🤖 正在处理您的请求，请稍候...\\n', 'type': 'chunk'}",
          "{'message': '🔄 AI正在思考中，请耐心等待...\\n', 'type': 'chunk'}"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "带会话聊天",
      "category": "聊天功能",
      "status": "FAIL",
      "duration": 45.01783871650696,
      "start_time": 1755230004.9740312,
      "end_time": 1755230049.99187,
      "expected": "200状态码，上下文相关回复",
      "actual": "状态码: 408",
      "error_message": null,
      "response_data": {
        "error": "AI处理超时，请稍后重试",
        "code": "QCLI_TIMEOUT",
        "http_status": 408,
        "details": {
          "service": "QCLI"
        },
        "suggestions": [
          "AI处理复杂问题需要较长时间，请耐心等待",
          "尝试简化问题或分解为多个小问题",
          "检查网络连接是否稳定",
          "如果经常超时，请联系系统管理员调整超时设置"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "创建会话",
      "category": "会话管理",
      "status": "PASS",
      "duration": 0.006506919860839844,
      "start_time": 1755230049.992299,
      "end_time": 1755230049.998806,
      "expected": "201状态码，包含session_id和created_at",
      "actual": "状态码: 201, 字段完整",
      "error_message": null,
      "response_data": {
        "session_id": "005ad350-571c-44b8-9145-cf23aa491337",
        "created_at": 1755230049.996306
      },
      "performance_data": {}
    },
    {
      "test_name": "获取会话",
      "category": "会话管理",
      "status": "PASS",
      "duration": 0.003887176513671875,
      "start_time": 1755230049.9988108,
      "end_time": 1755230050.002698,
      "expected": "200状态码，会话详细信息",
      "actual": "状态码: 200",
      "error_message": null,
      "response_data": {
        "session_id": "005ad350-571c-44b8-9145-cf23aa491337",
        "created_at": 1755230049.996306,
        "last_activity": 1755230049.996306,
        "message_count": 0,
        "work_directory": "sessions/005ad350-571c-44b8-9145-cf23aa491337",
        "absolute_work_directory": "/Users/yiming/Downloads/all_the_kiro/kiro&Q_pythonflask_qcli/kiro_pythonflask_qcli/sessions/005ad350-571c-44b8-9145-cf23aa491337"
      },
      "performance_data": {}
    },
    {
      "test_name": "获取会话文件",
      "category": "会话管理",
      "status": "PASS",
      "duration": 0.002736806869506836,
      "start_time": 1755230050.002701,
      "end_time": 1755230050.0054379,
      "expected": "200状态码，文件列表",
      "actual": "状态码: 200",
      "error_message": null,
      "response_data": {
        "session_id": "005ad350-571c-44b8-9145-cf23aa491337",
        "work_directory": "sessions/005ad350-571c-44b8-9145-cf23aa491337",
        "absolute_work_directory": "/Users/yiming/Downloads/all_the_kiro/kiro&Q_pythonflask_qcli/kiro_pythonflask_qcli/sessions/005ad350-571c-44b8-9145-cf23aa491337",
        "files": [],
        "file_count": 0
      },
      "performance_data": {}
    },
    {
      "test_name": "删除会话",
      "category": "会话管理",
      "status": "PASS",
      "duration": 0.003098011016845703,
      "start_time": 1755230050.005441,
      "end_time": 1755230050.008539,
      "expected": "200状态码，删除确认",
      "actual": "状态码: 200",
      "error_message": null,
      "response_data": {
        "message": "会话已删除"
      },
      "performance_data": {}
    },
    {
      "test_name": "空请求体",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.003087282180786133,
      "start_time": 1755230050.008725,
      "end_time": 1755230050.0118122,
      "expected": "状态码400，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 400, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "请求体不能为空",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "无效JSON",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.003951072692871094,
      "start_time": 1755230050.0118139,
      "end_time": 1755230050.015765,
      "expected": "状态码400，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 400, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "请求体不能为空",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "缺少消息字段",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.0022499561309814453,
      "start_time": 1755230050.0157702,
      "end_time": 1755230050.0180202,
      "expected": "状态码400，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 400, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "缺少必需字段: message",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "不存在的会话",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.002040863037109375,
      "start_time": 1755230050.018021,
      "end_time": 1755230050.020062,
      "expected": "状态码404，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 404, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "指定的会话不存在",
        "code": "SESSION_NOT_FOUND",
        "http_status": 404,
        "details": {
          "session_id": "nonexistent-session-id"
        },
        "suggestions": [
          "请检查会话ID是否正确",
          "会话可能已过期，请创建新会话",
          "使用 POST /api/v1/sessions 创建新会话"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "不存在的接口",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.0013802051544189453,
      "start_time": 1755230050.020063,
      "end_time": 1755230050.0214431,
      "expected": "状态码404，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 404, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "请求的接口不存在",
        "code": "ENDPOINT_NOT_FOUND",
        "http_status": 404,
        "suggestions": [
          "请检查请求URL是否正确",
          "确认API版本号是否正确",
          "参考API文档了解可用的接口"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "方法不允许",
      "category": "错误处理",
      "status": "PASS",
      "duration": 0.0013468265533447266,
      "start_time": 1755230050.021445,
      "end_time": 1755230050.0227919,
      "expected": "状态码405，包含['error', 'code', 'suggestions']和建议",
      "actual": "状态码: 405, 字段完整: True, 有建议: True",
      "error_message": null,
      "response_data": {
        "error": "请求方法不被允许",
        "code": "METHOD_NOT_ALLOWED",
        "http_status": 405,
        "suggestions": [
          "请检查HTTP方法是否正确（GET、POST等）",
          "确认接口支持的请求方法",
          "参考API文档了解正确的请求方式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "响应时间测试",
      "category": "性能测试",
      "status": "PASS",
      "duration": 20.71151304244995,
      "start_time": 1755230050.022859,
      "end_time": 1755230070.7343721,
      "expected": "< 30秒响应时间",
      "actual": "响应时间: 20.71秒",
      "error_message": null,
      "response_data": {
        "duration": 20.711501121520996,
        "status_code": 200
      },
      "performance_data": {
        "response_time": 20.711501121520996
      }
    },
    {
      "test_name": "进度提示测试",
      "category": "性能测试",
      "status": "PASS",
      "duration": 0.006423234939575195,
      "start_time": 1755230070.7343738,
      "end_time": 1755230070.740797,
      "expected": "< 2秒首个响应",
      "actual": "首个响应时间: 0.00秒",
      "error_message": null,
      "response_data": {
        "first_chunk_time": 0.003306150436401367,
        "chunk_count": 3
      },
      "performance_data": {}
    },
    {
      "test_name": "空消息",
      "category": "边界测试",
      "status": "PASS",
      "duration": 0.0037467479705810547,
      "start_time": 1755230070.7409642,
      "end_time": 1755230070.744711,
      "expected": "状态码 400",
      "actual": "状态码: 400",
      "error_message": null,
      "response_data": {
        "error": "消息内容不能为空",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "超长消息",
      "category": "边界测试",
      "status": "PASS",
      "duration": 0.0035872459411621094,
      "start_time": 1755230070.744716,
      "end_time": 1755230070.7483032,
      "expected": "状态码 400",
      "actual": "状态码: 400",
      "error_message": null,
      "response_data": {
        "error": "消息内容过长，最大4000字符",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "特殊字符",
      "category": "边界测试",
      "status": "FAIL",
      "duration": 0.0034902095794677734,
      "start_time": 1755230070.748309,
      "end_time": 1755230070.751799,
      "expected": "状态码 200",
      "actual": "状态码: 400",
      "error_message": null,
      "response_data": {
        "error": "消息内容包含不允许的字符",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "无效会话ID格式",
      "category": "边界测试",
      "status": "PASS",
      "duration": 0.0019989013671875,
      "start_time": 1755230070.751801,
      "end_time": 1755230070.7538,
      "expected": "状态码 400",
      "actual": "状态码: 400",
      "error_message": null,
      "response_data": {
        "error": "会话ID格式无效",
        "code": "VALIDATION_ERROR",
        "http_status": 400,
        "suggestions": [
          "请检查请求参数格式是否正确",
          "确保所有必需字段都已提供",
          "参考API文档了解正确的请求格式"
        ]
      },
      "performance_data": {}
    },
    {
      "test_name": "重复内容检测",
      "category": "内容质量",
      "status": "PASS",
      "duration": 21.129920959472656,
      "start_time": 1755230070.753932,
      "end_time": 1755230091.883853,
      "expected": "无明显重复内容",
      "actual": "句子总数: 6, 唯一句子: 5, 有重复: False",
      "error_message": null,
      "response_data": {
        "message_length": 401,
        "sentences": 6,
        "unique_sentences": 5
      },
      "performance_data": {}
    },
    {
      "test_name": "内容完整性检测",
      "category": "内容质量",
      "status": "PASS",
      "duration": 22.572375059127808,
      "start_time": 1755230091.883859,
      "end_time": 1755230114.456234,
      "expected": "完整的回复内容",
      "actual": "开头完整: True, 长度合理: True, 长度: 590",
      "error_message": null,
      "response_data": {
        "message_length": 590,
        "starts_incomplete": false,
        "message_preview": "我理解您想要基于之前的对话历史来回答问题，但是我没有看到您提供的对话历史内容，也没有看到您的具体问题。\n请您：\n1. 提供之前的对话历史内容\n2. 明确说明您希望我回答的具体问题\n这样我就能基于上下文"
      },
      "performance_data": {}
    },
    {
      "test_name": "中文支持测试",
      "category": "内容质量",
      "status": "PASS",
      "duration": 19.659574031829834,
      "start_time": 1755230114.4562361,
      "end_time": 1755230134.1158102,
      "expected": "主要使用中文回复",
      "actual": "中文字符比例: 60.63%, 总字符数: 696",
      "error_message": null,
      "response_data": {
        "chinese_ratio": 0.6063218390804598,
        "total_chars": 696,
        "chinese_chars": 422
      },
      "performance_data": {}
    }
  ]
}